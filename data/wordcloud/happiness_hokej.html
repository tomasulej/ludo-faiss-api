<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
	<title>D3 CSV</title>

</head>
<body>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="d3.layout.cloud.js"></script>
<script type="text/javascript">

var fill = d3.scale.category20();

var slova = [], emocia = [], farba = [], 
    width = 800, 
    height = 600;
    
farba[-3]="#550000";
farba[-2]="#801515";
farba[-1]="#AA3939";
farba[1]="#2D882D";
farba[2]="#116611";
farba[3]="#004400";


    
function c(slovo) {
    //alert(emocia[slovo]);
	return farba[emocia[slovo]];
}

d3.csv("data_happiness_hokej.csv", function(data) {
    // build the list of city names
    data.forEach( function (d) {
        slova.push(d.slovo+";"+d.vyskyty);
        emocia[d.slovo]=d.emocia;
        
    });




    
    
    d3.layout.cloud().size([1000, 600])
        .words(slova.map(function(d) {
            var spl = d.split(';');
             //alert(split[1]); 
             var velkost=parseInt(spl[1])*20;
             //alert(velkost);
             return {text: spl[0], size: velkost};
        }))
        .rotate(function() { return ~~(Math.random() * 2) * 0; })
        .font("Impact")
        .fontSize(function(d) { return d.size; })
        .on("end", draw)
        .start();

});

function draw(words) {
d3.select("body").append("svg")
    .attr("width", 1200)
    .attr("height", 600)
    .append("g")
    .attr("transform", "translate(600,300)")


    .selectAll("text")
    .data(words)
    .enter().append("text")
    .style("font-size", function(d) { return d.size + "px"; })
    .style("font-family", "Impact")
    
    
    .style("fill", function(d, i) { return fill(i); })
    //.style("fill", function(d, i) { return color(i); })
    .style("fill", function(d, i) { 
	       //alert(JSON.stringify(d, null, 4)); 
	       //alert ();
	       return c(d.text);

	       //return farba(d.text);
	       })
    .attr("text-anchor", "middle")
    .attr("transform", function(d) {
        return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
    })
    .text(function(d) { return d.text; });
}			
</script>

<br clear="both">




</body>


</html>